---
phase: 01-foundation-core-monitoring
task: 0
total_tasks: 7
status: planned
last_updated: 2026-02-11T16:38:14.817Z
---

<current_state>
Phase 1 is fully planned and ready for execution. All planning artifacts are complete:
- CONTEXT.md: User decisions captured from /gsd:discuss-phase
- RESEARCH.md: Technical research completed (OAuth endpoint, Keychain access, JSONL parsing, libraries)
- 3 PLAN.md files: 01-01 (foundation), 01-02 (data layer), 01-03 (UI & settings)

No code has been written yet. Next step is to execute the plans.
</current_state>

<completed_work>

**Project Initialization:**
- PROJECT.md created with full context (ClaudeMon - Claude usage monitor)
- config.json with YOLO mode, standard depth, parallel execution, quality model profile
- Research completed: STACK.md, FEATURES.md, ARCHITECTURE.md, PITFALLS.md, SUMMARY.md
- REQUIREMENTS.md with 43 v1 requirements across 8 categories
- ROADMAP.md with 5 phases, all requirements mapped

**Phase 1 Planning:**
- /gsd:discuss-phase 1 completed - captured user decisions on:
  - Menu bar icon: text percentage default, subtle gradient colors, click=popover, right-click=menu
  - Popover layout: big percentage at top, comfortable density, gear icon for settings
  - Data refresh: configurable (default 1 min), spinner + timestamp visible, background refresh
  - Error states: notify once on OAuth fail, 3 retries then manual, "Show details" expander
- /gsd:plan-phase 1 completed:
  - Research done (OAuth endpoint, Keychain, libraries, JSONL structure)
  - 3 plans created in 3 waves (sequential)
  - Verification passed

</completed_work>

<remaining_work>

**Phase 1 Execution:**
- Plan 01 (Wave 1): Xcode project foundation, menu bar app shell, data models, mock polling
- Plan 02 (Wave 2): OAuth client, token manager, JSONL parser, real data pipeline
- Plan 03 (Wave 3): Popover UI polish, settings window, right-click menu, human verification

**Phases 2-5:**
- Phase 2: Alerts & Notifications
- Phase 3: Usage Trends & API Integration
- Phase 4: Floating Window
- Phase 5: Theming & Design Polish

</remaining_work>

<decisions_made>

**Data Sources:**
- OAuth endpoint (`/api/oauth/usage`) is primary source
- Claude Code JSONL parsing is fallback when OAuth unavailable
- Admin API is optional enhancement (requires org admin key)

**Architecture:**
- Swift/SwiftUI native app targeting macOS 14+
- Three libraries: MenuBarExtraAccess, SettingsAccess, KeychainAccess
- Non-sandboxed distribution via GitHub (required for ~/.claude access)
- Credentials read from macOS Keychain ("Claude Code-credentials" service)

**User Decisions (locked):**
- Menu bar shows text percentage by default (user can change to Claude logo or gauge)
- Subtle gradient colors, NOT harsh traffic light colors
- Click opens popover, right-click shows context menu
- Default refresh interval 1 minute, configurable in settings
- Error: notify once on OAuth failure, silent fallback, 3 retries then manual

</decisions_made>

<blockers>
None currently. Research addressed key technical questions:
- OAuth endpoint verified and documented
- Keychain access pattern confirmed
- JSONL structure verified from actual files
- Right-click on MenuBarExtra has fallback approaches
</blockers>

<context>
This is a greenfield native macOS app for monitoring Claude usage. The user wants a clean, modern, lightweight menu bar app that shows usage at a glance. Key insight from research: OAuth endpoint is undocumented but used by competitors, could change anytime - graceful degradation to JSONL is important.

The 3 plans are sequential: foundation (shell + mock data) -> data layer (real OAuth/JSONL) -> UI polish (views + settings). Plan 03 ends with a human verification checkpoint.

Quality model profile selected - using Opus for research/planning agents.
</context>

<next_action>
Run: `/gsd:execute-phase 1`

This will execute all 3 plans in sequence:
1. Create Xcode project with SPM dependencies, menu bar app shell
2. Implement OAuth client, token manager, JSONL parser, wire real data
3. Build polished popover UI, settings window, right-click menu, then human verification
</next_action>
